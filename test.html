<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cohen's Kappa Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .kappa-input {
            transition: all 0.3s ease;
        }
        .kappa-input:focus {
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15);
        }
        .result-card {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        }
    </style>
</head>
<body class="min-h-full bg-gradient-to-br from-blue-50 to-blue-100 font-sans">
    <main class="container mx-auto px-4 py-8 max-w-4xl">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-blue-900 mb-2">Cohen's Kappa Calculator</h1>
            <p class="text-blue-700">Assess agreement between two researchers</p>
        </header>

        <div class="bg-white rounded-2xl shadow-lg p-8 mb-6">
            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <!-- Entrada de Dados -->
                <div class="space-y-6">
                    <!-- Agreements -->
                    <div class="bg-green-50 rounded-xl p-4">
                        <h3 class="text-lg font-semibold text-green-800 mb-4">Agreements</h3>
                        <div class="space-y-3">
                            <div>
                                <label for="p1-pos-pos" class="block text-sm font-medium text-green-700 mb-2 flex items-center gap-2">
                                    (R1) Positive / (R2) Positive
                                    <div class="relative group">
                                        <svg class="w-4 h-4 text-green-600 cursor-help" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
                                        </svg>
                                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10">
                                            Both researchers agree on POSITIVE result<br>
                                            Example: Both identified presence of disease
                                            <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-800"></div>
                                        </div>
                                    </div>
                                </label>
                                <input type="number" id="p1-pos-pos" min="0" value="0" 
                                       class="kappa-input w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent bg-slate-50">
                            </div>
                            <div>
                                <label for="p1-neg-neg" class="block text-sm font-medium text-green-700 mb-2 flex items-center gap-2">
                                    (R1) Negative / (R2) Negative
                                    <div class="relative group">
                                        <svg class="w-4 h-4 text-green-600 cursor-help" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
                                        </svg>
                                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10">
                                            Both researchers agree on NEGATIVE result<br>
                                            Example: Both did not identify presence of disease
                                            <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-800"></div>
                                        </div>
                                    </div>
                                </label>
                                <input type="number" id="p1-neg-neg" min="0" value="0" 
                                       class="kappa-input w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent bg-slate-50">
                            </div>
                        </div>
                    </div>

                    <!-- Disagreements -->
                    <div class="bg-red-50 rounded-xl p-4">
                        <h3 class="text-lg font-semibold text-red-800 mb-4">Disagreements</h3>
                        <div class="space-y-3">
                            <div>
                                <label for="p1-neg-pos" class="block text-sm font-medium text-red-700 mb-2 flex items-center gap-2">
                                    (R1) Negative / (R2) Positive
                                    <div class="relative group">
                                        <svg class="w-4 h-4 text-red-600 cursor-help" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
                                        </svg>
                                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10">
                                            R1 says NEGATIVE, R2 says POSITIVE<br>
                                            Example: R1 doesn't see disease, R2 sees disease
                                            <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-800"></div>
                                        </div>
                                    </div>
                                </label>
                                <input type="number" id="p1-neg-pos" min="0" value="0" 
                                       class="kappa-input w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-400 focus:border-transparent bg-slate-50">
                            </div>
                            <div>
                                <label for="p1-pos-neg" class="block text-sm font-medium text-red-700 mb-2 flex items-center gap-2">
                                    (R1) Positive / (R2) Negative
                                    <div class="relative group">
                                        <svg class="w-4 h-4 text-red-600 cursor-help" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
                                        </svg>
                                        <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10">
                                            R1 says POSITIVE, R2 says NEGATIVE<br>
                                            Example: R1 sees disease, R2 doesn't see disease
                                            <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-800"></div>
                                        </div>
                                    </div>
                                </label>
                                <input type="number" id="p1-pos-neg" min="0" value="0" 
                                       class="kappa-input w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-red-400 focus:border-transparent bg-slate-50">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Confusion Matrix -->
                <div class="space-y-4">
                    <div class="bg-blue-50 rounded-xl p-4">
                        <h3 class="text-lg font-medium text-blue-700 mb-3">Confusion Matrix</h3>
                        <div class="grid grid-cols-3 gap-2 text-sm">
                            <div></div>
                            <div class="text-center font-medium text-blue-700">R2: Pos</div>
                            <div class="text-center font-medium text-blue-700">R2: Neg</div>
                            <div class="font-medium text-blue-700">R1: Pos</div>
                            <div class="bg-white rounded-lg p-3 text-center font-bold text-blue-900" id="matrix-pp">0</div>
                            <div class="bg-white rounded-lg p-3 text-center font-bold text-blue-900" id="matrix-pn">0</div>
                            <div class="font-medium text-blue-700">R1: Neg</div>
                            <div class="bg-white rounded-lg p-3 text-center font-bold text-blue-900" id="matrix-np">0</div>
                            <div class="bg-white rounded-lg p-3 text-center font-bold text-blue-900" id="matrix-nn">0</div>
                        </div>
                        <div class="mt-3 text-xs text-blue-600 bg-white rounded-lg p-2">
                            <strong>Legend:</strong> R1 = Researcher 1 | R2 = Researcher 2
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center mb-6">
                <button onclick="calculateKappa()" 
                        class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg">
                    Calculate Kappa
                </button>
            </div>

            <!-- Result -->
            <div id="result-section" class="result-card rounded-xl p-6 hidden">
                <h3 class="text-xl font-bold text-blue-900 mb-4 text-center">Result</h3>
                <div class="text-center mb-4">
                    <div class="text-4xl font-bold text-blue-800 mb-2" id="kappa-value">-</div>
                    <div class="text-lg font-semibold text-blue-700" id="kappa-interpretation">-</div>
                </div>
                <div class="bg-white rounded-lg p-4">
                    <h4 class="font-semibold text-blue-800 mb-2">Interpretation (Kitchenham et al.):</h4>
                    <div class="text-sm text-blue-700 space-y-1">
                        <div><strong>< 0:</strong> Poor</div>
                        <div><strong>0.00 - 0.20:</strong> Poor</div>
                        <div><strong>0.21 - 0.40:</strong> Fair</div>
                        <div><strong>0.41 - 0.60:</strong> Moderate</div>
                        <div><strong>0.61 - 0.80:</strong> Good/Substantial</div>
                        <div><strong>0.81 - 1.00:</strong> Very Good/Almost Perfect</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Atualizar matriz visual quando inputs mudarem
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', updateMatrix);
        });

        function updateMatrix() {
            document.getElementById('matrix-pp').textContent = document.getElementById('p1-pos-pos').value || '0';
            document.getElementById('matrix-pn').textContent = document.getElementById('p1-pos-neg').value || '0';
            document.getElementById('matrix-np').textContent = document.getElementById('p1-neg-pos').value || '0';
            document.getElementById('matrix-nn').textContent = document.getElementById('p1-neg-neg').value || '0';
        }

        function calculateKappa() {
            // Obter valores dos inputs
            const a = parseInt(document.getElementById('p1-pos-pos').value) || 0; // Concordância positiva
            const b = parseInt(document.getElementById('p1-pos-neg').value) || 0; // P1 pos, P2 neg
            const c = parseInt(document.getElementById('p1-neg-pos').value) || 0; // P1 neg, P2 pos
            const d = parseInt(document.getElementById('p1-neg-neg').value) || 0; // Concordância negativa

            const total = a + b + c + d;

            if (total === 0) {
                alert('Please enter at least one value greater than zero.');
                return;
            }

            // Calcular concordância observada (Po)
            const po = (a + d) / total;

            // Calcular concordância esperada (Pe)
            const marginalP1Pos = (a + b) / total;
            const marginalP1Neg = (c + d) / total;
            const marginalP2Pos = (a + c) / total;
            const marginalP2Neg = (b + d) / total;

            const pe = (marginalP1Pos * marginalP2Pos) + (marginalP1Neg * marginalP2Neg);

            // Calcular Kappa
            const kappa = (po - pe) / (1 - pe);

            // Interpret result using Kitchenham et al. classification
            let interpretation = '';
            if (kappa < 0) {
                interpretation = 'Poor';
            } else if (kappa <= 0.20) {
                interpretation = 'Poor';
            } else if (kappa <= 0.40) {
                interpretation = 'Fair';
            } else if (kappa <= 0.60) {
                interpretation = 'Moderate';
            } else if (kappa <= 0.80) {
                interpretation = 'Good/Substantial';
            } else {
                interpretation = 'Very Good/Almost Perfect';
            }

            // Exibir resultado
            document.getElementById('kappa-value').textContent = kappa.toFixed(3);
            document.getElementById('kappa-interpretation').textContent = interpretation;
            document.getElementById('result-section').classList.remove('hidden');

            // Scroll suave para o resultado
            document.getElementById('result-section').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center' 
            });
        }

        // Inicializar matriz
        updateMatrix();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'991b35f6918cf1f2',t:'MTc2MDk5MTU3My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
